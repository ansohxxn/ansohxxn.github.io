---
title:  "Chapter 12-5. ê¸°íƒ€ : ìˆ˜ì˜í•˜ê¸° (í˜¸í¡ ì‹œìŠ¤í…œ)" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-12-14
last_modified_at: 2020-12-14
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}

## ğŸš€ ìˆ˜ì˜ 

### ğŸ“œPlayerController

```c#
    [SerializeField] private float swimSpeed;
    [SerializeField] private float swimFastSpeed;
    [SerializeField] private float upSwimSpeed;
    private float applySpeed;
```
```c#
    void Update()  
    {
        if (isActivated && GameManager.canPlayerMove)
        {
            WaterCheck();
            IsGround();
            TryJump();
            if (!GameManager.isWater)
                TryRun();
            TryCrouch();
            Move();
            MoveCheck();
            CameraRotation();
            CharacterRotation();
        }
    }

    private void WaterCheck()
    {
        if(GameManager.isWater)
        {
            if (Input.GetKeyDown(KeyCode.LeftShift))
                applySpeed = swimFastSpeed;
            else
                applySpeed = swimSpeed;
        }
    }

    private void TryJump()
    {
        if (Input.GetKeyDown(KeyCode.Space) && isGround && !GameManager.isWater && theStatusController.GetCurrentSP() > 0)
            Jump();
        else if (Input.GetKey(KeyCode.Space) && GameManager.isWater)
            UpSwim();
    }

    private void UpSwim()
    {
        myRigid.velocity = transform.up * upSwimSpeed;
    }
```

![image](https://user-images.githubusercontent.com/42318591/102083618-322fc380-3e57-11eb-803a-5e82c22824da.png)


<br>

### ğŸ“œWeaponManager

```c#
    public IEnumerator WeaponInCoroutine()
    {
        isChangeWeapon = true;
        currentWeaponAnim.SetTrigger("Weapon_Out");

        yield return new WaitForSeconds(changeweaponDelayTime);

        currentWeapon.gameObject.SetActive(false);
    }

    public void WeaponOut()
    {
        isChangeWeapon = false;
        currentWeapon.gameObject.SetActive(true);
    }
```

<br>

### ğŸ“œGameManager

```c#
    private WeaponManager theWeaponManager;
    private bool flag = false;

    void Start()
    {
        Cursor.lockState = CursorLockMode.Locked;
        Cursor.visible = false;

        theWeaponManager = FindObjectOfType<WeaponManager>();
    }

    void Update()
    {
        if (isOpenInventory || isOpenCraftManual || isOnComputer || isOpenArchemyTable)
        {
            Cursor.lockState = CursorLockMode.None;
            Cursor.visible = true;

            canPlayerMove = false;
        }
        else
        {
            Cursor.lockState = CursorLockMode.Locked;
            Cursor.visible = false;

            canPlayerMove = true;
        }

        if (isWater)
        {
            if (!flag)
            {
                StopAllCoroutines();
                StartCoroutine(theWeaponManager.WeaponInCoroutine());
                flag = true; // 1ë²ˆë§Œ ì‹¤í–‰ë˜ê²Œ flag ì‚¬ìš©
            }
        }
        else
        {
            if (flag)
            {
                theWeaponManager.WeaponOut();
                flag = false;
            }
        }
    }
```

<br>

### ğŸ“œCrossHair

`if (!GameManager.isWater)`ì¼ ë•Œë§Œ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ


<br>

## ğŸš€ í˜¸í¡ ê²Œì´ì§€

### âœˆ í˜¸í¡ ê²Œì´ì§€ UI

![image](https://user-images.githubusercontent.com/42318591/102084046-e16c9a80-3e57-11eb-91b9-ae11796869e8.png)


![image](https://user-images.githubusercontent.com/42318591/102084018-d44fab80-3e57-11eb-9019-134ef1133ac6.png)

![image](https://user-images.githubusercontent.com/42318591/102084080-efbab680-3e57-11eb-90de-a448ecd2d872.png)


ë² ì´ìŠ¤ ìœ ì•„ì´ êº¼ë†“ëŠ”ë‹¤.

### ğŸ“œWater

```c#
    [SerializeField] private float totalOxygen;
    private float currentOxygen;
    private float temp;

    [SerializeField] private GameObject go_BaseUI;
    [SerializeField] private Text text_TotalOxygen;
    [SerializeField] private Text text_currentOxygen;
    [SerializeField] private Image image_gauge;
```
```c#
    void Start()
    {
        originColor = RenderSettings.fogColor;
        originFogDensity = RenderSettings.fogDensity;

        originDrag = thePlayer.GetComponent<Rigidbody>().drag;

        currentOxygen = totalOxygen;
        text_TotalOxygen.text = totalOxygen.ToString();
    }

    void Update()
    {
        if (GameManager.isWater)
        {
            currentBreatheTime += Time.deltaTime;
            if (currentBreatheTime >= breatheTime)
            {
                SoundManager.instance.PlaySE(sound_WaterBreathe);
                currentBreatheTime = 0;
            }
        }

        DecreaseOxygen();
    }

    private void DecreaseOxygen()
    {
        if(GameManager.isWater)
        {
            currentOxygen -= Time.deltaTime;
            text_currentOxygen.text = Mathf.RoundToInt(currentOxygen).ToString();
            image_gauge.fillAmount = currentOxygen / totalOxygen; // %

            if (currentOxygen <= 0)
            {
                temp += Time.deltaTime;
                if (temp >= 1)
                {
                    thePlayer.GetComponent<StatusController>().DecreaseHP(1); // 1ì´ˆì— 1ì”© ë‹¬ê²Œ
                    temp = 0;
                }
            }
        }
    }

    private void GetInWater(Collider _player)
    {
        SoundManager.instance.PlaySE(sound_WaterIn);

        go_BaseUI.SetActive(true);

        // ...

    private void GetOutWater(Collider _player)
    {
        SoundManager.instance.PlaySE(sound_WaterOut);

        if (GameManager.isWater)
        {
            go_BaseUI.SetActive(false);
            // ...
```

![image](https://user-images.githubusercontent.com/42318591/102084109-006b2c80-3e58-11eb-95f6-61f8daee3725.png)


![image](https://user-images.githubusercontent.com/42318591/102084211-2b558080-3e58-11eb-9157-ab0c9b40709d.png)


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}