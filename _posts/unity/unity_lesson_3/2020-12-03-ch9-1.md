---
title:  "Chapter 9-1. ê±´ì¶• : ê±´ì¶•ì°½ UI, ê±´ì¶• í”„ë¦¬ë·°, ê±´ì¶• ê°€ëŠ¥ ì—¬ë¶€ íŒë³„" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-12-03
last_modified_at: 2020-12-03
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}


# ê±´ì¶• ì‹œìŠ¤í…œ

## ğŸš˜ UI ë§Œë“¤ê¸°


### ğŸ“œCraftManual.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

[System.Serializable]
public class Craft
{
    public string craftName; // ì´ë¦„
    public GameObject go_prefab; // ì‹¤ì œ ì„¤ì¹˜ ë  í”„ë¦¬íŒ¹
    public GameObject go_PreviewPrefab; // ë¯¸ë¦¬ ë³´ê¸° í”„ë¦¬íŒ¹
}

public class CraftManual : MonoBehaviour
{
    private bool isActivated = false;  // CraftManual UI í™œì„± ìƒíƒœ
    private bool isPreviewActivated = false; // ë¯¸ë¦¬ ë³´ê¸° í™œì„±í™” ìƒíƒœ

    [SerializeField]
    private GameObject go_BaseUI; // ê¸°ë³¸ ë² ì´ìŠ¤ UI

    [SerializeField]
    private Craft[] craft_fire;  // ëª¨ë‹¥ë¶ˆìš© íƒ­

    private GameObject go_Preview; // ë¯¸ë¦¬ ë³´ê¸° í”„ë¦¬íŒ¹ì„ ë‹´ì„ ë³€ìˆ˜
    private GameObject go_Prefab; // ì‹¤ì œ ìƒì„±ë  í”„ë¦¬íŒ¹ì„ ë‹´ì„ ë³€ìˆ˜ 

    [SerializeField]
    private Transform tf_Player;  // í”Œë ˆì´ì–´ ìœ„ì¹˜

    private RaycastHit hitInfo;
    [SerializeField]
    private LayerMask layerMask;
    [SerializeField]
    private float range;


    public void SlotClick(int _slotNumber)
    {
        go_Preview = Instantiate(craft_fire[_slotNumber].go_PreviewPrefab, tf_Player.position + tf_Player.forward, Quaternion.identity);
        go_Prefab = craft_fire[_slotNumber].go_prefab;
        isPreviewActivated = true;
        go_BaseUI.SetActive(false);
    }

    void Update()
    {
        if (Input.GetKeyDown(KeyCode.Tab) && !isPreviewActivated)
            Window();

        if (isPreviewActivated)
            PreviewPositionUpdate();

        if (Input.GetButtonDown("Fire1"))
            Build();

        if (Input.GetKeyDown(KeyCode.Escape))
            Cancel();
    }

    private void PreviewPositionUpdate()
    {
        if (Physics.Raycast(tf_Player.position, tf_Player.forward, out hitInfo, range, layerMask))
        {
            if (hitInfo.transform != null)
            {
                Vector3 _location = hitInfo.point;
                go_Preview.transform.position = _location;

                Debug.Log(_location);
                Debug.Log(go_Preview.transform.position);
            }
        }
    }

    private void Build()
    {
        if(isPreviewActivated && go_Preview.GetComponent<PreviewObject>().isBuildable())
        {
            Instantiate(go_Prefab, hitInfo.point, Quaternion.identity);
            Destroy(go_Preview);
            isActivated = false;
            isPreviewActivated = false;
            go_Preview = null;
            go_Prefab = null;
        }
    }

    private void Window()
    {
        if (!isActivated)
            OpenWindow();
        else
            CloseWindow();
    }

    private void OpenWindow()
    {
        isActivated = true;
        go_BaseUI.SetActive(true);
    }

    private void CloseWindow()
    {
        isActivated = false;
        go_BaseUI.SetActive(false);
    }

    private void Cancel()
    {
        if (isPreviewActivated)
            Destroy(go_Preview);

        isActivated = false;
        isPreviewActivated = false;

        go_Preview = null;
        go_Prefab = null;

        go_BaseUI.SetActive(false);
    }
}

```

### ğŸ“œPreviewObject.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PreviewObject : MonoBehaviour
{
    private List<Collider> colliderList = new List<Collider>(); // ì¶©ëŒí•œ ì˜¤ë¸Œì íŠ¸ë“¤ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸

    [SerializeField]
    private int layerGround; // ì§€í˜• ë ˆì´ì–´ (ë¬´ì‹œí•˜ê²Œ í•  ê²ƒ)
    private const int IGNORE_RAYCAST_LAYER = 2;  // ignore_raycast (ë¬´ì‹œí•˜ê²Œ í•  ê²ƒ)

    [SerializeField]
    private Material green;
    [SerializeField]
    private Material red;


    void Update()
    {
        ChangeColor();
    }

    private void ChangeColor()
    {
        if (colliderList.Count > 0)
            SetColor(red);
        else
            SetColor(green);
    }

    private void SetColor(Material mat)
    {
        foreach(Transform tf_Child in this.transform)
        {
            Material [] newMaterials = new Material[tf_Child.GetComponent<Renderer>().materials.Length];

            for (int i = 0; i < newMaterials.Length; i++)
            {
                newMaterials[i] = mat;
            }

            tf_Child.GetComponent<Renderer>().materials = newMaterials;
        }
    }

    private void OnTriggerEnter(Collider other)
    {
        if (other.gameObject.layer != layerGround && other.gameObject.layer != IGNORE_RAYCAST_LAYER)
            colliderList.Add(other);
    }

    private void OnTriggerExit(Collider other)
    {
        if (other.gameObject.layer != layerGround && other.gameObject.layer != IGNORE_RAYCAST_LAYER)
            colliderList.Remove(other);
    }

    public bool isBuildable()
    {
        return colliderList.Count == 0;
    }
}

```

![image](https://user-images.githubusercontent.com/42318591/100995099-a8e8d900-359a-11eb-902e-a854a0fe4923.png)

ë¹ˆ(ğŸ“œCraftManual ë¶™ìŒ)
    ì „ì²´ ì´ë¯¸ì§€
        ë¹ˆ
            ì´ë¯¸ì§€ + ë²„íŠ¼ (ì‘ì€ ëª¨ë‹¥ë¶ˆ ë°°ê²½)
                ì´ë¯¸ì§€ (ì‘ì€ ëª¨ë‹¥ë¶ˆ)
        ë¹ˆ
            ì´ë¯¸ì§€ + ë²„íŠ¼ (í° ëª¨ë‹¥ë¶ˆ ë°°ê²½)
                ì´ë¯¸ì§€ (í° ëª¨ë‹¥ë¶ˆ)
                ì´ë¦„ í…ìŠ¤íŠ¸
                ì„¤ëª… í…ìŠ¤íŠ¸

![image](https://user-images.githubusercontent.com/42318591/100994887-6de6a580-359a-11eb-9a9d-89e33f09d94e.png)

![image](https://user-images.githubusercontent.com/42318591/100995479-2c0a2f00-359b-11eb-9f9f-5b5bbca70851.png)

![image](https://user-images.githubusercontent.com/42318591/100995585-53f99280-359b-11eb-8e6a-23fdcc7fffef.png)

![image](https://user-images.githubusercontent.com/42318591/100995947-d41ff800-359b-11eb-84e5-24a97458d786.png)


ìŠ¬ë¡¯ ë²„íŠ¼ 

- ui ë§Œë“¤ê¸°
- ìŠ¤í¬ë¦½íŠ¸
- ë²„íŠ¼ ê¸°ëŠ¥
  - ì»´í¬ë„ŒíŠ¸ ì„¤ì •
  - Onclick
- í”„ë¦¬ë·° ë§Œë“¤ê¸°
- ë¹Œë“œ(ì§“ê¸°)

![image](https://user-images.githubusercontent.com/42318591/100995731-82776d80-359b-11eb-8141-f10ce6dbba1c.png)

![image](https://user-images.githubusercontent.com/42318591/100995769-91f6b680-359b-11eb-9f88-6cec26d4e032.png)


ì§“ì§€ ëª»í•˜ëŠ” ê³³ì€ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ + ëª»ì§“ê²Œ
(PreviewObject)
Terrain ë ˆì´ì–´
CreateìŠ¤í¬ë¦½íŠ¸ ë ˆì´ì–´ defaultì—ì„œ ìˆ˜ì •
í”„ë¦¬íŒ¹ ë°•ìŠ¤ ì½œë¼ì´ë”
ë‹¤ë¥¸ ê²ƒë“¤ rigidbody ì¶”ê°€ì‹œì¼œ ì¤Œ
ì¿¨ë§ë§ˆìŠ¤í¬

![image](https://user-images.githubusercontent.com/42318591/100996011-e863f500-359b-11eb-9574-7436bfaaa85a.png)

![image](https://user-images.githubusercontent.com/42318591/100996053-f4e84d80-359b-11eb-89e0-a12e65bd0c5b.png)




***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}