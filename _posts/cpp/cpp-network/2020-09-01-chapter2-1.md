---
title:  "Chapter 2.1 ë™ê¸° I/O ë°©ì‹ì˜ TCP/IP Echo ì„œë²„" 

categories:
  -  Cpp Network 
tags:
  - [Cpp, Programming, Network]

toc: true
toc_sticky: true

date: 2020-07-08
last_modified_at: 2020-07-08
---

ìµœí¥ë°°ë‹˜ì˜ ì±… **Boost.Asioë¥¼ ì‚¬ìš©í•œ ë„¤íŠ¸ì›Œí¬ í”„ë¡œê·¸ë˜ë°** ì„ ê³µë¶€í•˜ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
{: .notice--warning}


# Chapter 2. ê°„ë‹¨í•œ Echo ì„œë²„, í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë¨ ë§Œë“¤ê¸°

![image](https://user-images.githubusercontent.com/42318591/91835247-1af01000-ec84-11ea-8be3-b3ce91f8abf2.png){: width="70%" height="70%"}{: .align-center}


# 2.1 ë™ê¸° I/O ë°©ì‹ì˜ TCP/IP Echo âœ¨ì„œë²„âœ¨

```cpp
#include <iostream>
#include <boost/asio.hpp>

using namespace std;

const char SERVER_IP[] = "127.0.0.1";
const unsigned short PORT_NUMBER = 3100;

int main()
{
	boost::asio::io_service io_service;
	boost::asio::ip::tcp::endpoint endpoint(boost::asio::ip::tcp::v4(), PORT_NUMBER);
	boost::asio::ip::tcp::acceptor acceptor(io_service, endpoint);

	boost::asio::ip::tcp::socket socket(io_service);
	acceptor.accept(socket);
	
	cout << "í´ë¼ì´ì–¸íŠ¸ ì ‘ì†" << endl;

	for (;;)
	{
		array<char, 128> buf;
		buf.assign(0);
		boost::system::error_code error;
		size_t len = socket.read_some(boost::asio::buffer(buf), error);

		if (error)
		{
			if (error == boost::asio::error::eof)
				cout << "í´ë¼ì´ì–¸íŠ¸ì™€ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤" << endl;
			else
				cout << "error No: " << error.value() << " error Message: " << error.message() << endl;
			break;
		}

		cout << "í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°›ì€ ë©”ì„¸ì§€: " << &buf[0] << endl;
		char szMessage[128] = { 0, };
		sprintf_s(szMessage, 128 - 1, "Re:%s", &buf[0]);
		int nMsgLen = strnlen_s(szMessage, 128 - 1);

		boost::system::error_code ignored_error;
		socket.write_some(boost::asio::buffer(szMessage, nMsgLen), ignored_error);
	}
	getchar();

	return 0;
}
```

<br>

```cpp
#include <iostream>
#include <boost/asio.hpp>

using namespace std;

const char SERVER_IP[] = "127.0.0.1";
const unsigned short PORT_NUMBER = 3100;

int main()
{
	boost::asio::io_service io_service;
	boost::asio::ip::tcp::endpoint endpoint(boost::asio::ip::address::from_string(SERVER_IP), PORT_NUMBER);

	boost::system::error_code connect_error;
	boost::asio::ip::tcp::socket socket(io_service);
	socket.connect(endpoint, connect_error);

	if (connect_error)
	{
		cout << "ì—°ê²° ì‹¤íŒ¨. error No: " << connect_error.value() << " , Message: " << connect_error.message() << endl;
		getchar();
		return 0;
	}
	else
		cout << "ì„œë²„ì— ì—°ê²° ì„±ê³µ!" << endl;

	for (int i = 0; i < 7; i++)
	{
		char szMessage[128] = { 0, };
		sprintf_s(szMessage, 128 - 1, "%d - Send Message", i);
		int nMsgLen = strnlen_s(szMessage, 128 - 1);

		boost::system::error_code ignored_error;
		socket.write_some(boost::asio::buffer(szMessage, nMsgLen), ignored_error);

		cout << "ì„œë²„ì— ë³´ë‚¸ ë©”ì„¸ì§€ : " << szMessage << endl;

		char buf[128] = { 0 };
		boost::system::error_code error;
		size_t len = socket.read_some(boost::asio::buffer(buf), error);

		if (error)
		{
			if (error == boost::asio::error::eof)
				cout << "ì„œë²„ì™€ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤" << endl;
			else
				cout << "error No: " << error.value() << " error Message: " << error.message().c_str() << endl;
			break;
		}

		cout << "ì„œë²„ë¡œë¶€í„° ë°›ì€ ë©”ì„¸ì§€ : " << &buf[0] << endl;
	}

	if (socket.is_open())
		socket.close();

	getchar();
	return 0;
}
```

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}